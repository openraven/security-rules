id: 132f680e-7819-432c-9259-2210c2e947dd
refId: aws-iam-and-security-iam-password-policy-length
type: asset
name: >
  Ensure IAM password policy requires minimum length of 14 or greater
description: >
  Password policies are, in part, used to enforce password complexity requirements. IAM
  password policies can be used to ensure password are at least a given length. It is
  recommended that the password policy require a minimum password length 14
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awsiamaccount
    WHERE (supplementaryconfiguration->'passwordPolicy' = 'null'
         OR supplementaryconfiguration->'passwordPolicy'->'minimumPasswordLength' < '14');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 1.0
