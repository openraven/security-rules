#opnrvn-r-13
ruleId: aws-iam-and-security-ensure-iam-password-policy-expires-password-90-days-or-less
cloudProvider: aws
description: >
  Insecure assets:
   - `empty-password-policy` has no configured password policy
   - `password-policy-exceeds` has maxPasswordAge = 120 which is exceeds 90 days limit
  Secure asset
   - `password-policy-valid` has maxPasswordAge = 90 and maxPasswordAge = 83 which both match the requirements
insecureAssets:
  empty-password-policy: >
    [{
     "documentId" : "TITMEubnP1OlM84G7_GzZg",
     "arn" : "AWSAccount",
     "resourceName" : "empty-password-policy",
     "resourceId" : null,
     "resourceType" : "AWS::Account",
     "awsRegion" : "aws-global",
     "awsAccountId" : "000000000000",
     "createdIso" : null,
     "updatedIso" : "2021-10-18T13:52:55.983955Z",
     "discoverySessionId" : null,
     "maxSizeInBytes" : null,
     "sizeInBytes" : null,
     "configuration" : {
       "GroupPolicySizeQuota" : 5120,
       "InstanceProfilesQuota" : 1000,
       "Policies" : 14,
       "GroupsPerUserQuota" : 10,
       "InstanceProfiles" : 6,
       "AttachedPoliciesPerUserQuota" : 10,
       "Users" : 2,
       "PoliciesQuota" : 1500,
       "Providers" : 2,
       "AccountMFAEnabled" : 0,
       "AccessKeysPerUserQuota" : 2,
       "AssumeRolePolicySizeQuota" : 2048,
       "PolicyVersionsInUseQuota" : 10000,
       "GlobalEndpointTokenVersion" : 1,
       "VersionsPerPolicyQuota" : 5,
       "AttachedPoliciesPerGroupQuota" : 10,
       "PolicySizeQuota" : 6144,
       "Groups" : 3,
       "AccountSigningCertificatesPresent" : 0,
       "UsersQuota" : 5000,
       "ServerCertificatesQuota" : 20,
       "MFADevices" : 1,
       "UserPolicySizeQuota" : 2048,
       "PolicyVersionsInUse" : 51,
       "ServerCertificates" : 0,
       "Roles" : 61,
       "RolesQuota" : 1000,
       "SigningCertificatesPerUserQuota" : 2,
       "MFADevicesInUse" : 1,
       "RolePolicySizeQuota" : 10240,
       "AttachedPoliciesPerRoleQuota" : 10,
       "AccountAccessKeysPresent" : 0,
       "GroupsQuota" : 300
     },
     "supplementaryConfiguration" : {
       "PasswordPolicy" : null,
       "VirtualMFADevices" : {
         "isTruncated" : false,
         "marker" : null
       }
     },
     "tags" : { },
     "discoveryMeta" : { }
    }]
secureAssets:
  password-policy-valid: >
    [{
     "documentId" : "JhD4MGTjML6P6UbGjqp2Dg",
     "arn" : "AWSAccount",
     "resourceName" : "password-policy-match",
     "resourceId" : null,
     "resourceType" : "AWS::Account",
     "awsRegion" : "aws-global",
     "awsAccountId" : "000000000000",
     "createdIso" : null,
     "updatedIso" : "2021-10-29T16:12:21.727925Z",
     "discoverySessionId" : null,
     "maxSizeInBytes" : null,
     "sizeInBytes" : null,
     "configuration" : {
       "GroupPolicySizeQuota" : 5120,
       "InstanceProfilesQuota" : 1000,
       "Policies" : 14,
       "GroupsPerUserQuota" : 10,
       "InstanceProfiles" : 6,
       "AttachedPoliciesPerUserQuota" : 10,
       "Users" : 2,
       "PoliciesQuota" : 1500,
       "Providers" : 2,
       "AccountMFAEnabled" : 1,
       "AccessKeysPerUserQuota" : 2,
       "AssumeRolePolicySizeQuota" : 2048,
       "PolicyVersionsInUseQuota" : 10000,
       "GlobalEndpointTokenVersion" : 1,
       "VersionsPerPolicyQuota" : 5,
       "AttachedPoliciesPerGroupQuota" : 10,
       "PolicySizeQuota" : 6144,
       "Groups" : 3,
       "AccountSigningCertificatesPresent" : 0,
       "UsersQuota" : 5000,
       "ServerCertificatesQuota" : 20,
       "MFADevices" : 1,
       "UserPolicySizeQuota" : 2048,
       "PolicyVersionsInUse" : 51,
       "ServerCertificates" : 0,
       "Roles" : 61,
       "RolesQuota" : 1000,
       "SigningCertificatesPerUserQuota" : 2,
       "MFADevicesInUse" : 1,
       "RolePolicySizeQuota" : 10240,
       "AttachedPoliciesPerRoleQuota" : 10,
       "AccountAccessKeysPresent" : 0,
       "GroupsQuota" : 300
     },
     "supplementaryConfiguration" : {
       "PasswordPolicy" : {
         "minimumPasswordLength" : 8,
         "requireSymbols" : false,
         "requireNumbers" : false,
         "requireUppercaseCharacters" : false,
         "requireLowercaseCharacters" : false,
         "allowUsersToChangePassword" : false,
         "expirePasswords" : true,
         "maxPasswordAge" : 90,
         "passwordReusePrevention" : null,
         "hardExpiry" : null
       },
       "VirtualMFADevices" : {
         "VirtualMFADevices" : [ {
           "serialNumber" : "arn:aws:iam::000000000000:mfa/root-account-mfa-device",
           "base32StringSeed" : null,
           "qrCodePNG" : null,
           "user" : {
             "path" : null,
             "userName" : "openraven-jason",
             "userId" : "000000000000",
             "arn" : "arn:aws:iam::000000000000:root",
             "createDate" : "2019-12-06T23:39:32Z",
             "passwordLastUsed" : "2021-01-03T02:24:22Z",
             "permissionsBoundary" : null,
             "tags" : null
           },
           "enableDate" : "2020-10-07T17:03:08Z"
         } ],
         "isTruncated" : false,
         "marker" : null
       }
     },
     "tags" : { },
     "discoveryMeta" : { }
    }, {
      "documentId" : "JhD4MGTjML6P6UbGjqp2Gg",
      "arn" : "AWS::Account",
      "resourceName" : "password-policy-less-then",
      "resourceId" : null,
      "resourceType" : "AWS::Account",
      "awsRegion" : "aws-global",
      "awsAccountId" : "000000000000",
      "createdIso" : null,
      "updatedIso" : "2021-10-29T16:12:21.727925Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "GroupPolicySizeQuota" : 5120,
        "InstanceProfilesQuota" : 1000,
        "Policies" : 14,
        "GroupsPerUserQuota" : 10,
        "InstanceProfiles" : 6,
        "AttachedPoliciesPerUserQuota" : 10,
        "Users" : 2,
        "PoliciesQuota" : 1500,
        "Providers" : 2,
        "AccountMFAEnabled" : 1,
        "AccessKeysPerUserQuota" : 2,
        "AssumeRolePolicySizeQuota" : 2048,
        "PolicyVersionsInUseQuota" : 10000,
        "GlobalEndpointTokenVersion" : 1,
        "VersionsPerPolicyQuota" : 5,
        "AttachedPoliciesPerGroupQuota" : 10,
        "PolicySizeQuota" : 6144,
        "Groups" : 3,
        "AccountSigningCertificatesPresent" : 0,
        "UsersQuota" : 5000,
        "ServerCertificatesQuota" : 20,
        "MFADevices" : 1,
        "UserPolicySizeQuota" : 2048,
        "PolicyVersionsInUse" : 51,
        "ServerCertificates" : 0,
        "Roles" : 61,
        "RolesQuota" : 1000,
        "SigningCertificatesPerUserQuota" : 2,
        "MFADevicesInUse" : 1,
        "RolePolicySizeQuota" : 10240,
        "AttachedPoliciesPerRoleQuota" : 10,
        "AccountAccessKeysPresent" : 0,
        "GroupsQuota" : 300
      },
      "supplementaryConfiguration" : {
        "PasswordPolicy" : {
          "minimumPasswordLength" : 8,
          "requireSymbols" : false,
          "requireNumbers" : false,
          "requireUppercaseCharacters" : false,
          "requireLowercaseCharacters" : false,
          "allowUsersToChangePassword" : false,
          "expirePasswords" : true,
          "maxPasswordAge" : 83,
          "passwordReusePrevention" : null,
          "hardExpiry" : null
        },
        "VirtualMFADevices" : {
          "VirtualMFADevices" : [ {
            "serialNumber" : "arn:aws:iam::000000000000:mfa/root-account-mfa-device",
            "base32StringSeed" : null,
            "qrCodePNG" : null,
            "user" : {
              "path" : null,
              "userName" : "openraven-jason",
              "userId" : "000000000000",
              "arn" : "arn:aws:iam::000000000000:root",
              "createDate" : "2019-12-06T23:39:32Z",
              "passwordLastUsed" : "2021-01-03T02:24:22Z",
              "permissionsBoundary" : null,
              "tags" : null
            },
            "enableDate" : "2020-10-07T17:03:08Z"
          } ],
          "isTruncated" : false,
          "marker" : null
        }
      },
      "tags" : { },
      "discoveryMeta" : { }
     }]
