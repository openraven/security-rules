ruleId: opnrvn-r-100
type: asset
ruleName: >
  Ensure that sinks are configured for all log entries
description: >
  It is recommended to create a sink that will export copies of all the log entries.
  This can help aggregate logs from multiple projects and export them to a Security Information and Event Management (SIEM).
severity: high
enabled: true
sql: >
  SELECT 'No active empty Logging Sink found with configured destination' AS asset_id
  WHERE NOT EXISTS (
      SELECT acc.asset_id
        FROM assets acc
       WHERE acc.resource_type = 'GCP::Logging::Sink'
         AND acc."configuration" ->> 'disabled_' = 'false'
         AND (acc."configuration" ->> 'destination_' IS NOT NULL
            AND acc."configuration" ->> 'destination_' <> '')
         AND (acc."configuration" ->> 'filter_' IS NULL
            OR acc."configuration" ->> 'filter_' = ''));
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9