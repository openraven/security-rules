ruleId: opnrvn-r-80
type: asset
ruleName: >
  Ensure that DNSSEC is enabled for Cloud DNS
description: >
  Domain Name System Security Extensions (DNSSEC) adds security to the DNS protocol by enabling DNS responses to be validated.
  Attackers can hijack this process of domain/IP lookup and redirect users to a malicious site through DNS hijacking and man-in- the-middle attacks.
  DNSSEC helps mitigate the risk of such attacks by cryptographically signing DNS records. As a result,
  it prevents attackers from issuing fake DNS responses that may misdirect browsers to nefarious websites.
severity: high
enabled: true
sql: >
  SELECT acc.asset_id
    FROM magpie.assets acc
   WHERE acc.resource_type = 'GCP::Dns::Zone'
     AND acc.configuration ->> 'nameServers' not like '%-private.%'
     AND acc.configuration -> 'dnsSecConfig' ->> 'state' = 'off'

remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9